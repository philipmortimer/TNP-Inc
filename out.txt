Targ TNP-D: 0it [00:00, ?it/s]Targ TNP-D: 1it [00:07,  7.64s/it]Targ TNP-D: 2it [00:12,  6.00s/it]Targ TNP-D: 3it [00:17,  5.51s/it]Targ TNP-D: 4it [00:22,  5.35s/it]Targ TNP-D: 5it [00:28,  5.40s/it]Targ TNP-D: 6it [00:34,  5.62s/it]Targ TNP-D: 7it [00:40,  6.00s/it]Targ TNP-D: 8it [00:48,  6.54s/it]Targ TNP-D: 9it [00:57,  7.19s/it]Targ TNP-D: 10it [01:06,  7.95s/it]Targ TNP-D: 11it [01:17,  8.80s/it]Targ TNP-D: 12it [01:29,  9.74s/it]Targ TNP-D: 13it [01:42, 10.76s/it]Targ TNP-D: 14it [01:56, 11.86s/it]Targ TNP-D: 15it [02:12, 13.05s/it]Targ TNP-D: 16it [02:29, 14.30s/it]Targ TNP-D: 17it [02:48, 15.63s/it]Targ TNP-D: 18it [03:08, 17.02s/it]Targ TNP-D: 19it [03:30, 18.47s/it]Targ TNP-D: 20it [03:54, 19.99s/it]Targ TNP-D: 21it [04:19, 21.56s/it]Targ TNP-D: 22it [04:46, 23.17s/it]Targ TNP-D: 23it [05:15, 24.84s/it]Targ TNP-D: 24it [05:45, 26.58s/it]Targ TNP-D: 25it [06:18, 28.38s/it]Targ TNP-D: 26it [06:53, 30.26s/it]Targ TNP-D: 27it [07:29, 32.19s/it]Targ TNP-D: 28it [08:08, 34.18s/it]Targ TNP-D: 29it [08:49, 36.26s/it]Targ TNP-D: 30it [09:33, 38.39s/it]Targ TNP-D: 31it [10:18, 40.58s/it]Targ TNP-D: 32it [11:06, 42.83s/it]Targ TNP-D: 33it [11:57, 45.16s/it]Targ TNP-D: 34it [12:50, 47.54s/it]Targ TNP-D: 35it [13:46, 49.97s/it]Targ TNP-D: 36it [14:44, 52.46s/it]Targ TNP-D: 37it [15:45, 55.01s/it]Targ TNP-D: 38it [16:49, 57.63s/it]Targ TNP-D: 39it [17:55, 60.30s/it]Targ TNP-D: 40it [19:05, 63.04s/it]Targ TNP-D: 41it [20:17, 65.83s/it]Targ TNP-D: 41it [20:17, 29.69s/it]
Targ incTNP-Batched: 0it [00:00, ?it/s]/home/pm846/.conda/envs/tnpp/lib/python3.10/site-packages/torch/backends/cuda/__init__.py:342: FutureWarning: torch.backends.cuda.sdp_kernel() is deprecated. In the future, this context manager will be removed. Please see, torch.nn.attention.sdpa_kernel() for the new context manager, with updated signature.
  warnings.warn(
Targ incTNP-Batched: 1it [00:06,  6.39s/it]Targ incTNP-Batched: 2it [00:12,  6.13s/it]Targ incTNP-Batched: 3it [00:18,  6.03s/it]Targ incTNP-Batched: 4it [00:24,  5.99s/it]Targ incTNP-Batched: 5it [00:30,  6.01s/it]Targ incTNP-Batched: 6it [00:36,  5.97s/it]Targ incTNP-Batched: 7it [00:42,  5.97s/it]Targ incTNP-Batched: 8it [00:48,  5.97s/it]Targ incTNP-Batched: 9it [00:53,  5.96s/it]Targ incTNP-Batched: 10it [00:59,  5.95s/it]Targ incTNP-Batched: 11it [01:05,  5.94s/it]Targ incTNP-Batched: 12it [01:11,  5.95s/it]Targ incTNP-Batched: 13it [01:17,  5.95s/it]Targ incTNP-Batched: 14it [01:23,  5.96s/it]Targ incTNP-Batched: 15it [01:29,  5.97s/it]Targ incTNP-Batched: 16it [01:35,  5.98s/it]Targ incTNP-Batched: 17it [01:41,  5.97s/it]Targ incTNP-Batched: 18it [01:47,  5.97s/it]Targ incTNP-Batched: 19it [01:53,  5.97s/it]Targ incTNP-Batched: 20it [01:59,  5.97s/it]Targ incTNP-Batched: 21it [02:05,  5.96s/it]Targ incTNP-Batched: 22it [02:11,  5.96s/it]Targ incTNP-Batched: 23it [02:17,  5.95s/it]Targ incTNP-Batched: 24it [02:23,  5.94s/it]Targ incTNP-Batched: 25it [02:29,  5.93s/it]Targ incTNP-Batched: 26it [02:35,  5.94s/it]Targ incTNP-Batched: 27it [02:41,  5.95s/it]Targ incTNP-Batched: 28it [02:47,  5.95s/it]Targ incTNP-Batched: 29it [02:53,  5.95s/it]Targ incTNP-Batched: 30it [02:59,  5.96s/it]Targ incTNP-Batched: 31it [03:05,  5.97s/it]Targ incTNP-Batched: 32it [03:11,  5.97s/it]Targ incTNP-Batched: 33it [03:17,  5.97s/it]Targ incTNP-Batched: 34it [03:23,  5.98s/it]Targ incTNP-Batched: 35it [03:28,  5.97s/it]Targ incTNP-Batched: 36it [03:34,  5.97s/it]Targ incTNP-Batched: 37it [03:40,  5.97s/it]Targ incTNP-Batched: 38it [03:46,  5.97s/it]Targ incTNP-Batched: 39it [03:52,  5.96s/it]Targ incTNP-Batched: 40it [03:58,  5.97s/it]Targ incTNP-Batched: 41it [04:04,  5.97s/it]Targ incTNP-Batched: 41it [04:04,  5.97s/it]
Targ incTNP-Batched (No Flash): 0it [00:00, ?it/s]Targ incTNP-Batched (No Flash): 1it [00:05,  5.70s/it]Targ incTNP-Batched (No Flash): 2it [00:11,  5.58s/it]Targ incTNP-Batched (No Flash): 3it [00:16,  5.54s/it]Targ incTNP-Batched (No Flash): 4it [00:22,  5.51s/it]Targ incTNP-Batched (No Flash): 5it [00:27,  5.51s/it]Targ incTNP-Batched (No Flash): 6it [00:33,  5.50s/it]Targ incTNP-Batched (No Flash): 7it [00:38,  5.50s/it]Targ incTNP-Batched (No Flash): 8it [00:44,  5.50s/it]Targ incTNP-Batched (No Flash): 9it [00:49,  5.50s/it]Targ incTNP-Batched (No Flash): 10it [00:55,  5.50s/it]Targ incTNP-Batched (No Flash): 11it [01:00,  5.50s/it]Targ incTNP-Batched (No Flash): 12it [01:06,  5.51s/it]Targ incTNP-Batched (No Flash): 13it [01:11,  5.51s/it]Targ incTNP-Batched (No Flash): 14it [01:17,  5.52s/it]Targ incTNP-Batched (No Flash): 15it [01:22,  5.54s/it]Targ incTNP-Batched (No Flash): 16it [01:28,  5.57s/it]Targ incTNP-Batched (No Flash): 17it [01:34,  5.62s/it]Targ incTNP-Batched (No Flash): 18it [01:40,  5.68s/it]Targ incTNP-Batched (No Flash): 19it [01:45,  5.76s/it]Targ incTNP-Batched (No Flash): 20it [01:51,  5.85s/it]Targ incTNP-Batched (No Flash): 21it [01:58,  5.94s/it]Targ incTNP-Batched (No Flash): 22it [02:04,  6.04s/it]Targ incTNP-Batched (No Flash): 23it [02:10,  6.16s/it]Targ incTNP-Batched (No Flash): 24it [02:17,  6.27s/it]Targ incTNP-Batched (No Flash): 25it [02:24,  6.39s/it]Targ incTNP-Batched (No Flash): 26it [02:30,  6.52s/it]Targ incTNP-Batched (No Flash): 27it [02:37,  6.65s/it]Targ incTNP-Batched (No Flash): 28it [02:44,  6.80s/it]Targ incTNP-Batched (No Flash): 29it [02:52,  6.95s/it]Targ incTNP-Batched (No Flash): 30it [02:59,  7.11s/it]Targ incTNP-Batched (No Flash): 31it [03:07,  7.27s/it]Targ incTNP-Batched (No Flash): 32it [03:15,  7.44s/it]Targ incTNP-Batched (No Flash): 33it [03:23,  7.61s/it]Targ incTNP-Batched (No Flash): 34it [03:31,  7.79s/it]Targ incTNP-Batched (No Flash): 35it [03:39,  7.96s/it]Targ incTNP-Batched (No Flash): 36it [03:48,  8.14s/it]Targ incTNP-Batched (No Flash): 37it [03:57,  8.31s/it]Targ incTNP-Batched (No Flash): 38it [04:05,  8.49s/it]Targ incTNP-Batched (No Flash): 39it [04:15,  8.68s/it]Targ incTNP-Batched (No Flash): 40it [04:24,  8.86s/it]Targ incTNP-Batched (No Flash): 41it [04:33,  9.04s/it]Targ incTNP-Batched (No Flash): 41it [04:33,  6.68s/it]
Targ CNP: 0it [00:00, ?it/s]Targ CNP: 1it [00:00,  1.01it/s]Targ CNP: 2it [00:01,  1.01it/s]Targ CNP: 3it [00:02,  1.02it/s]Targ CNP: 4it [00:03,  1.02it/s]Targ CNP: 5it [00:04,  1.02it/s]Targ CNP: 6it [00:05,  1.02it/s]Targ CNP: 7it [00:06,  1.02it/s]Targ CNP: 8it [00:07,  1.02it/s]Targ CNP: 9it [00:08,  1.02it/s]Targ CNP: 10it [00:09,  1.02it/s]Targ CNP: 11it [00:10,  1.02it/s]Targ CNP: 12it [00:11,  1.02it/s]Targ CNP: 13it [00:12,  1.02it/s]Targ CNP: 14it [00:13,  1.02it/s]Targ CNP: 15it [00:14,  1.02it/s]Targ CNP: 16it [00:15,  1.02it/s]Targ CNP: 17it [00:16,  1.02it/s]Targ CNP: 18it [00:17,  1.02it/s]Targ CNP: 19it [00:18,  1.02it/s]Targ CNP: 20it [00:19,  1.02it/s]Targ CNP: 21it [00:20,  1.02it/s]Targ CNP: 22it [00:21,  1.02it/s]Targ CNP: 23it [00:22,  1.02it/s]Targ CNP: 24it [00:23,  1.02it/s]Targ CNP: 25it [00:24,  1.02it/s]Targ CNP: 26it [00:25,  1.02it/s]Targ CNP: 27it [00:26,  1.02it/s]Targ CNP: 28it [00:27,  1.02it/s]Targ CNP: 29it [00:28,  1.02it/s]Targ CNP: 30it [00:29,  1.02it/s]Targ CNP: 31it [00:30,  1.02it/s]Targ CNP: 32it [00:31,  1.02it/s]Targ CNP: 33it [00:32,  1.02it/s]Targ CNP: 34it [00:33,  1.02it/s]Targ CNP: 35it [00:34,  1.02it/s]Targ CNP: 36it [00:35,  1.02it/s]Targ CNP: 37it [00:36,  1.02it/s]Targ CNP: 38it [00:37,  1.02it/s]Targ CNP: 39it [00:38,  1.01it/s]Targ CNP: 40it [00:39,  1.01it/s]Targ CNP: 41it [00:40,  1.01it/s]Targ CNP: 41it [00:40,  1.02it/s]
/rds/user/pm846/hpc-work/Thesis/TNP-Inc/tnp/networks/setconv.py:31: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  (torch.tensor(init_lengthscale).exp() - 1).log(),
/home/pm846/.conda/envs/tnpp/lib/python3.10/site-packages/torch/functional.py:512: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3587.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Targ ConvCNP (100 x 100): 0it [00:00, ?it/s]Targ ConvCNP (100 x 100): 1it [00:07,  7.71s/it]Targ ConvCNP (100 x 100): 2it [00:15,  7.66s/it]Targ ConvCNP (100 x 100): 3it [00:22,  7.64s/it]Targ ConvCNP (100 x 100): 4it [00:30,  7.63s/it]Targ ConvCNP (100 x 100): 5it [00:38,  7.63s/it]Targ ConvCNP (100 x 100): 6it [00:45,  7.63s/it]Targ ConvCNP (100 x 100): 7it [00:53,  7.63s/it]Targ ConvCNP (100 x 100): 8it [01:01,  7.63s/it]Targ ConvCNP (100 x 100): 9it [01:08,  7.64s/it]Targ ConvCNP (100 x 100): 10it [01:16,  7.64s/it]Targ ConvCNP (100 x 100): 11it [01:24,  7.64s/it]Targ ConvCNP (100 x 100): 12it [01:31,  7.65s/it]Targ ConvCNP (100 x 100): 13it [01:39,  7.65s/it]Targ ConvCNP (100 x 100): 14it [01:47,  7.65s/it]Targ ConvCNP (100 x 100): 15it [01:54,  7.66s/it]Targ ConvCNP (100 x 100): 16it [02:02,  7.66s/it]Targ ConvCNP (100 x 100): 17it [02:10,  7.67s/it]Targ ConvCNP (100 x 100): 18it [02:17,  7.67s/it]Targ ConvCNP (100 x 100): 19it [02:25,  7.67s/it]Targ ConvCNP (100 x 100): 20it [02:33,  7.68s/it]Targ ConvCNP (100 x 100): 21it [02:41,  7.82s/it]Targ ConvCNP (100 x 100): 22it [02:48,  7.78s/it]Targ ConvCNP (100 x 100): 23it [02:56,  7.76s/it]Targ ConvCNP (100 x 100): 24it [03:04,  7.74s/it]Targ ConvCNP (100 x 100): 25it [03:12,  7.73s/it]Targ ConvCNP (100 x 100): 26it [03:19,  7.72s/it]Targ ConvCNP (100 x 100): 27it [03:27,  7.72s/it]Targ ConvCNP (100 x 100): 28it [03:35,  7.72s/it]Targ ConvCNP (100 x 100): 29it [03:43,  7.88s/it]Targ ConvCNP (100 x 100): 30it [03:51,  7.84s/it]Targ ConvCNP (100 x 100): 31it [03:58,  7.80s/it]Targ ConvCNP (100 x 100): 32it [04:06,  7.78s/it]Targ ConvCNP (100 x 100): 33it [04:14,  7.77s/it]Targ ConvCNP (100 x 100): 34it [04:22,  7.76s/it]Targ ConvCNP (100 x 100): 35it [04:30,  8.06s/it]Targ ConvCNP (100 x 100): 36it [04:38,  7.97s/it]Targ ConvCNP (100 x 100): 37it [04:46,  7.90s/it]Targ ConvCNP (100 x 100): 38it [04:54,  7.86s/it]Targ ConvCNP (100 x 100): 39it [05:01,  7.83s/it]Targ ConvCNP (100 x 100): 40it [05:10,  7.97s/it]Targ ConvCNP (100 x 100): 41it [05:17,  7.92s/it]Targ ConvCNP (100 x 100): 41it [05:17,  7.75s/it]
Targ ConvCNP (125 x 125): 0it [00:00, ?it/s]/home/pm846/.conda/envs/tnpp/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
Targ ConvCNP (125 x 125): 1it [00:11, 11.62s/it]Targ ConvCNP (125 x 125): 2it [00:23, 11.62s/it]Targ ConvCNP (125 x 125): 3it [00:34, 11.62s/it]Targ ConvCNP (125 x 125): 4it [00:46, 11.63s/it]Targ ConvCNP (125 x 125): 5it [00:58, 11.63s/it]Targ ConvCNP (125 x 125): 6it [01:09, 11.64s/it]Targ ConvCNP (125 x 125): 7it [01:21, 11.64s/it]Targ ConvCNP (125 x 125): 8it [01:33, 11.65s/it]Targ ConvCNP (125 x 125): 9it [01:44, 11.65s/it]Targ ConvCNP (125 x 125): 10it [01:56, 11.66s/it]Targ ConvCNP (125 x 125): 11it [02:08, 11.66s/it]Targ ConvCNP (125 x 125): 12it [02:19, 11.67s/it]Targ ConvCNP (125 x 125): 13it [02:31, 11.67s/it]Targ ConvCNP (125 x 125): 14it [02:43, 11.68s/it]Targ ConvCNP (125 x 125): 15it [02:54, 11.69s/it]Targ ConvCNP (125 x 125): 16it [03:06, 11.69s/it]Targ ConvCNP (125 x 125): 17it [03:18, 11.70s/it]Targ ConvCNP (125 x 125): 18it [03:30, 11.70s/it]Targ ConvCNP (125 x 125): 19it [03:41, 11.71s/it]Targ ConvCNP (125 x 125): 20it [03:53, 11.72s/it]Targ ConvCNP (125 x 125): 21it [04:05, 11.72s/it]Targ ConvCNP (125 x 125): 22it [04:16, 11.73s/it]Targ ConvCNP (125 x 125): 23it [04:28, 11.73s/it]Targ ConvCNP (125 x 125): 24it [04:40, 11.74s/it]Targ ConvCNP (125 x 125): 25it [04:52, 11.75s/it]Targ ConvCNP (125 x 125): 26it [05:03, 11.75s/it]Targ ConvCNP (125 x 125): 27it [05:15, 11.76s/it]Targ ConvCNP (125 x 125): 28it [05:27, 11.77s/it]Targ ConvCNP (125 x 125): 29it [05:39, 11.89s/it]Targ ConvCNP (125 x 125): 30it [05:51, 11.87s/it]Targ ConvCNP (125 x 125): 31it [06:03, 11.85s/it]Targ ConvCNP (125 x 125): 32it [06:15, 11.83s/it]Targ ConvCNP (125 x 125): 33it [06:27, 12.13s/it]Targ ConvCNP (125 x 125): 34it [06:39, 12.04s/it]Targ ConvCNP (125 x 125): 35it [06:51, 11.97s/it]Targ ConvCNP (125 x 125): 36it [07:04, 12.15s/it]Targ ConvCNP (125 x 125): 37it [07:16, 12.06s/it]Targ ConvCNP (125 x 125): 38it [07:27, 12.00s/it]Targ ConvCNP (125 x 125): 39it [07:40, 12.22s/it]Targ ConvCNP (125 x 125): 40it [07:52, 12.11s/it]Targ ConvCNP (125 x 125): 41it [08:04, 12.04s/it]Targ ConvCNP (125 x 125): 41it [08:04, 11.81s/it]
Targ ConvCNP (150 x 150): 0it [00:00, ?it/s]Targ ConvCNP (150 x 150): 1it [00:16, 16.20s/it]Targ ConvCNP (150 x 150): 2it [00:32, 16.19s/it]Targ ConvCNP (150 x 150): 3it [00:48, 16.20s/it]Targ ConvCNP (150 x 150): 4it [01:04, 16.20s/it]Targ ConvCNP (150 x 150): 5it [01:21, 16.21s/it]Targ ConvCNP (150 x 150): 6it [01:37, 16.22s/it]Targ ConvCNP (150 x 150): 7it [01:53, 16.22s/it]Targ ConvCNP (150 x 150): 8it [02:09, 16.23s/it]Targ ConvCNP (150 x 150): 9it [02:25, 16.24s/it]Targ ConvCNP (150 x 150): 10it [02:42, 16.25s/it]Targ ConvCNP (150 x 150): 11it [02:58, 16.25s/it]Targ ConvCNP (150 x 150): 12it [03:14, 16.26s/it]Targ ConvCNP (150 x 150): 13it [03:31, 16.27s/it]Targ ConvCNP (150 x 150): 14it [03:47, 16.28s/it]Targ ConvCNP (150 x 150): 15it [04:03, 16.29s/it]Targ ConvCNP (150 x 150): 16it [04:19, 16.29s/it]Targ ConvCNP (150 x 150): 17it [04:36, 16.30s/it]Targ ConvCNP (150 x 150): 18it [04:52, 16.31s/it]Targ ConvCNP (150 x 150): 19it [05:08, 16.32s/it]Targ ConvCNP (150 x 150): 20it [05:25, 16.33s/it]Targ ConvCNP (150 x 150): 21it [05:41, 16.34s/it]Targ ConvCNP (150 x 150): 22it [05:58, 16.34s/it]Targ ConvCNP (150 x 150): 23it [06:14, 16.35s/it]Targ ConvCNP (150 x 150): 24it [06:30, 16.36s/it]Targ ConvCNP (150 x 150): 25it [06:47, 16.37s/it]Targ ConvCNP (150 x 150): 26it [07:03, 16.38s/it]Targ ConvCNP (150 x 150): 27it [07:20, 16.39s/it]Targ ConvCNP (150 x 150): 28it [07:36, 16.40s/it]Targ ConvCNP (150 x 150): 29it [07:54, 16.96s/it]Targ ConvCNP (150 x 150): 30it [08:11, 16.80s/it]Targ ConvCNP (150 x 150): 31it [08:28, 17.00s/it]Targ ConvCNP (150 x 150): 32it [08:45, 16.84s/it]Targ ConvCNP (150 x 150): 33it [09:02, 17.04s/it]Targ ConvCNP (150 x 150): 34it [09:19, 16.87s/it]Targ ConvCNP (150 x 150): 35it [09:37, 17.23s/it]Targ ConvCNP (150 x 150): 36it [09:53, 17.01s/it]Targ ConvCNP (150 x 150): 37it [10:11, 17.21s/it]Targ ConvCNP (150 x 150): 38it [10:27, 17.00s/it]Targ ConvCNP (150 x 150): 39it [10:46, 17.55s/it]Targ ConvCNP (150 x 150): 40it [11:03, 17.24s/it]Targ ConvCNP (150 x 150): 41it [11:22, 17.76s/it]Targ ConvCNP (150 x 150): 41it [11:22, 16.64s/it]
Exact cache already present: True
Using cached elevation
Exact cache already present: True
Exact cache already present: True
Exact cache already present: True
wandb:   1 of 1 files downloaded.  
incTNP-Batched eval: 0it [00:00, ?it/s]Adjusting worker 0 num_batches from 125 to 125.
[rank: 0] Seed set to 0
incTNP-Batched eval: 1it [01:05, 65.44s/it]incTNP-Batched eval: 2it [02:40, 82.86s/it]incTNP-Batched eval: 3it [03:21, 63.89s/it]incTNP-Batched eval: 4it [03:51, 50.39s/it]incTNP-Batched eval: 5it [04:12, 39.82s/it]incTNP-Batched eval: 6it [05:53, 60.66s/it]incTNP-Batched eval: 7it [06:53, 60.30s/it]incTNP-Batched eval: 8it [07:29, 52.73s/it]incTNP-Batched eval: 9it [07:57, 44.90s/it]incTNP-Batched eval: 10it [08:53, 48.35s/it]incTNP-Batched eval: 11it [10:51, 69.61s/it]incTNP-Batched eval: 12it [12:18, 75.02s/it]incTNP-Batched eval: 13it [12:50, 61.80s/it]incTNP-Batched eval: 14it [13:45, 60.01s/it]incTNP-Batched eval: 15it [15:02, 64.88s/it]incTNP-Batched eval: 16it [16:12, 66.62s/it]incTNP-Batched eval: 17it [17:30, 69.90s/it]incTNP-Batched eval: 18it [18:43, 70.85s/it]incTNP-Batched eval: 19it [19:41, 67.14s/it]incTNP-Batched eval: 20it [20:23, 59.46s/it]incTNP-Batched eval: 21it [20:55, 51.09s/it]incTNP-Batched eval: 22it [22:12, 58.88s/it]incTNP-Batched eval: 23it [22:45, 51.38s/it]incTNP-Batched eval: 24it [24:22, 65.00s/it]incTNP-Batched eval: 25it [26:06, 76.53s/it]incTNP-Batched eval: 26it [27:21, 76.09s/it]incTNP-Batched eval: 27it [29:17, 88.26s/it]incTNP-Batched eval: 28it [30:22, 81.08s/it]incTNP-Batched eval: 29it [31:37, 79.44s/it]incTNP-Batched eval: 30it [32:10, 65.53s/it]incTNP-Batched eval: 31it [32:26, 50.48s/it]incTNP-Batched eval: 32it [33:52, 61.29s/it]incTNP-Batched eval: 33it [34:06, 46.90s/it]incTNP-Batched eval: 34it [34:43, 43.99s/it]incTNP-Batched eval: 35it [36:02, 54.61s/it]incTNP-Batched eval: 36it [37:08, 58.11s/it]incTNP-Batched eval: 37it [38:20, 62.27s/it]incTNP-Batched eval: 38it [38:59, 55.08s/it]incTNP-Batched eval: 39it [39:22, 45.57s/it]incTNP-Batched eval: 40it [41:13, 65.05s/it]incTNP-Batched eval: 41it [42:09, 62.53s/it]incTNP-Batched eval: 42it [43:18, 64.25s/it]incTNP-Batched eval: 43it [43:51, 54.87s/it]incTNP-Batched eval: 44it [44:07, 43.25s/it]incTNP-Batched eval: 45it [44:26, 36.14s/it]incTNP-Batched eval: 46it [44:47, 31.48s/it]incTNP-Batched eval: 47it [46:35, 54.62s/it]incTNP-Batched eval: 48it [48:05, 65.13s/it]incTNP-Batched eval: 49it [48:27, 52.19s/it]incTNP-Batched eval: 50it [49:16, 51.11s/it]incTNP-Batched eval: 51it [49:26, 38.91s/it]incTNP-Batched eval: 52it [50:31, 46.69s/it]incTNP-Batched eval: 53it [51:03, 42.27s/it]incTNP-Batched eval: 54it [51:46, 42.51s/it]incTNP-Batched eval: 55it [53:26, 59.64s/it]incTNP-Batched eval: 56it [53:46, 47.77s/it]incTNP-Batched eval: 57it [54:59, 55.58s/it]incTNP-Batched eval: 58it [56:25, 64.55s/it]incTNP-Batched eval: 59it [56:50, 52.63s/it]incTNP-Batched eval: 60it [57:08, 42.39s/it]incTNP-Batched eval: 61it [58:15, 49.57s/it]incTNP-Batched eval: 62it [59:02, 49.02s/it]incTNP-Batched eval: 63it [59:38, 45.16s/it]incTNP-Batched eval: 64it [1:01:25, 63.44s/it]incTNP-Batched eval: 65it [1:02:19, 60.79s/it]incTNP-Batched eval: 66it [1:02:43, 49.66s/it]incTNP-Batched eval: 67it [1:03:04, 41.15s/it]incTNP-Batched eval: 68it [1:03:23, 34.38s/it]incTNP-Batched eval: 69it [1:03:47, 31.48s/it]incTNP-Batched eval: 70it [1:05:42, 56.35s/it]incTNP-Batched eval: 71it [1:06:46, 58.59s/it]incTNP-Batched eval: 72it [1:07:51, 60.55s/it]incTNP-Batched eval: 73it [1:09:36, 73.86s/it]incTNP-Batched eval: 74it [1:10:09, 61.82s/it]incTNP-Batched eval: 75it [1:11:06, 60.26s/it]incTNP-Batched eval: 76it [1:12:58, 75.61s/it]incTNP-Batched eval: 77it [1:14:15, 76.22s/it]incTNP-Batched eval: 78it [1:15:00, 66.88s/it]incTNP-Batched eval: 79it [1:16:48, 79.25s/it]incTNP-Batched eval: 80it [1:17:02, 59.44s/it]incTNP-Batched eval: 81it [1:17:25, 48.50s/it]incTNP-Batched eval: 82it [1:17:42, 39.21s/it]incTNP-Batched eval: 83it [1:18:12, 36.51s/it]incTNP-Batched eval: 84it [1:19:45, 53.30s/it]incTNP-Batched eval: 85it [1:21:24, 67.03s/it]incTNP-Batched eval: 86it [1:21:56, 56.67s/it]incTNP-Batched eval: 87it [1:22:46, 54.61s/it]incTNP-Batched eval: 88it [1:23:53, 58.15s/it]incTNP-Batched eval: 89it [1:24:44, 56.20s/it]incTNP-Batched eval: 90it [1:25:08, 46.42s/it]incTNP-Batched eval: 91it [1:26:58, 65.53s/it]incTNP-Batched eval: 92it [1:28:42, 77.01s/it]incTNP-Batched eval: 93it [1:29:01, 59.75s/it]incTNP-Batched eval: 94it [1:29:32, 51.11s/it]incTNP-Batched eval: 95it [1:29:54, 42.46s/it]incTNP-Batched eval: 96it [1:31:29, 58.06s/it]incTNP-Batched eval: 97it [1:32:11, 53.34s/it]incTNP-Batched eval: 98it [1:33:41, 64.43s/it]incTNP-Batched eval: 99it [1:33:56, 49.33s/it]incTNP-Batched eval: 100it [1:34:59, 53.59s/it]incTNP-Batched eval: 101it [1:35:23, 44.72s/it]incTNP-Batched eval: 102it [1:35:54, 40.42s/it]incTNP-Batched eval: 103it [1:36:24, 37.57s/it]incTNP-Batched eval: 104it [1:37:46, 50.82s/it]incTNP-Batched eval: 105it [1:39:23, 64.69s/it]incTNP-Batched eval: 106it [1:40:34, 66.38s/it]incTNP-Batched eval: 107it [1:41:01, 54.70s/it]incTNP-Batched eval: 108it [1:42:23, 62.76s/it]incTNP-Batched eval: 109it [1:44:16, 77.97s/it]incTNP-Batched eval: 110it [1:46:09, 88.39s/it]incTNP-Batched eval: 111it [1:46:19, 65.02s/it]incTNP-Batched eval: 112it [1:46:42, 52.31s/it]incTNP-Batched eval: 113it [1:48:36, 70.75s/it]incTNP-Batched eval: 114it [1:49:02, 57.57s/it]incTNP-Batched eval: 115it [1:50:13, 61.59s/it]incTNP-Batched eval: 116it [1:51:43, 69.97s/it]incTNP-Batched eval: 117it [1:53:35, 82.65s/it]incTNP-Batched eval: 118it [1:55:18, 88.77s/it]incTNP-Batched eval: 119it [1:56:22, 81.17s/it]incTNP-Batched eval: 120it [1:58:03, 87.17s/it]incTNP-Batched eval: 121it [1:59:00, 78.27s/it]incTNP-Batched eval: 122it [1:59:22, 61.22s/it]incTNP-Batched eval: 123it [1:59:52, 51.90s/it]incTNP-Batched eval: 124it [2:01:47, 70.76s/it]incTNP-Batched eval: 125it [2:03:10, 74.54s/it]incTNP-Batched eval: 125it [2:03:10, 59.12s/it]
--------------------
Model: incTNP-Batched
Mean LL: 0.7728641469478608 STD LL: 0.010852159482250854 Mean RMSE: 0.13420535027980804 STD RMSE: 0.0013931274999488669 Num Samples: 50 Mean UnrRMSE: 0.9640290336608887 STD UnrRMSE: 0.005396812043636562 Total Unroltime: 6537.1517578125

Exact cache already present: True
Exact cache already present: True
Exact cache already present: True
wandb:   1 of 1 files downloaded.  
CNP eval: 0it [00:00, ?it/s]CNP eval: 1it [00:01,  1.17s/it]CNP eval: 2it [00:02,  1.34s/it]CNP eval: 3it [00:03,  1.24s/it]CNP eval: 4it [00:04,  1.17s/it]CNP eval: 5it [00:05,  1.11s/it]CNP eval: 6it [00:07,  1.23s/it]CNP eval: 7it [00:08,  1.23s/it]CNP eval: 8it [00:09,  1.18s/it]CNP eval: 9it [00:10,  1.13s/it]CNP eval: 10it [00:11,  1.15s/it]CNP eval: 11it [00:13,  1.27s/it]CNP eval: 12it [00:14,  1.31s/it]CNP eval: 13it [00:15,  1.23s/it]CNP eval: 14it [00:16,  1.21s/it]CNP eval: 15it [00:18,  1.26s/it]CNP eval: 16it [00:19,  1.27s/it]CNP eval: 17it [00:20,  1.29s/it]CNP eval: 18it [00:22,  1.29s/it]CNP eval: 19it [00:23,  1.26s/it]CNP eval: 20it [00:24,  1.22s/it]CNP eval: 21it [00:25,  1.16s/it]CNP eval: 22it [00:26,  1.21s/it]CNP eval: 23it [00:27,  1.17s/it]CNP eval: 24it [00:29,  1.25s/it]CNP eval: 25it [00:30,  1.31s/it]CNP eval: 26it [00:32,  1.31s/it]CNP eval: 27it [00:33,  1.38s/it]CNP eval: 28it [00:34,  1.34s/it]CNP eval: 29it [00:36,  1.33s/it]CNP eval: 30it [00:37,  1.25s/it]CNP eval: 31it [00:38,  1.18s/it]CNP eval: 32it [00:39,  1.24s/it]CNP eval: 33it [00:40,  1.16s/it]CNP eval: 34it [00:41,  1.14s/it]CNP eval: 35it [00:43,  1.19s/it]CNP eval: 36it [00:44,  1.21s/it]CNP eval: 37it [00:45,  1.24s/it]CNP eval: 38it [00:46,  1.20s/it]CNP eval: 39it [00:47,  1.14s/it]CNP eval: 40it [00:49,  1.24s/it]CNP eval: 41it [00:50,  1.23s/it]CNP eval: 42it [00:51,  1.24s/it]CNP eval: 43it [00:52,  1.18s/it]CNP eval: 44it [00:53,  1.13s/it]CNP eval: 45it [00:54,  1.09s/it]CNP eval: 46it [00:55,  1.06s/it]CNP eval: 47it [00:57,  1.18s/it]CNP eval: 48it [00:58,  1.25s/it]CNP eval: 49it [00:59,  1.17s/it]CNP eval: 50it [01:00,  1.17s/it]CNP eval: 51it [01:01,  1.12s/it]CNP eval: 52it [01:03,  1.16s/it]CNP eval: 53it [01:04,  1.12s/it]CNP eval: 54it [01:05,  1.12s/it]CNP eval: 55it [01:06,  1.22s/it]CNP eval: 56it [01:07,  1.15s/it]CNP eval: 57it [01:08,  1.20s/it]CNP eval: 58it [01:10,  1.25s/it]CNP eval: 59it [01:11,  1.17s/it]CNP eval: 60it [01:12,  1.12s/it]CNP eval: 61it [01:13,  1.16s/it]CNP eval: 62it [01:14,  1.16s/it]CNP eval: 63it [01:15,  1.13s/it]CNP eval: 64it [01:17,  1.23s/it]CNP eval: 65it [01:18,  1.22s/it]CNP eval: 66it [01:19,  1.15s/it]CNP eval: 67it [01:20,  1.10s/it]CNP eval: 68it [01:21,  1.07s/it]CNP eval: 69it [01:22,  1.05s/it]CNP eval: 70it [01:23,  1.19s/it]CNP eval: 71it [01:25,  1.20s/it]CNP eval: 72it [01:26,  1.22s/it]CNP eval: 73it [01:27,  1.29s/it]CNP eval: 74it [01:28,  1.22s/it]CNP eval: 75it [01:30,  1.21s/it]CNP eval: 76it [01:31,  1.29s/it]CNP eval: 77it [01:32,  1.30s/it]CNP eval: 78it [01:34,  1.25s/it]CNP eval: 79it [01:35,  1.32s/it]CNP eval: 80it [01:36,  1.22s/it]CNP eval: 81it [01:37,  1.15s/it]CNP eval: 82it [01:38,  1.11s/it]CNP eval: 83it [01:39,  1.08s/it]CNP eval: 84it [01:40,  1.18s/it]CNP eval: 85it [01:42,  1.26s/it]CNP eval: 86it [01:43,  1.20s/it]CNP eval: 87it [01:44,  1.19s/it]CNP eval: 88it [01:45,  1.21s/it]CNP eval: 89it [01:47,  1.20s/it]CNP eval: 90it [01:48,  1.13s/it]CNP eval: 91it [01:49,  1.24s/it]CNP eval: 92it [01:50,  1.30s/it]CNP eval: 93it [01:51,  1.21s/it]CNP eval: 94it [01:52,  1.15s/it]CNP eval: 95it [01:53,  1.11s/it]CNP eval: 96it [01:55,  1.21s/it]CNP eval: 97it [01:56,  1.18s/it]CNP eval: 98it [01:57,  1.25s/it]CNP eval: 99it [01:58,  1.17s/it]CNP eval: 100it [02:00,  1.19s/it]CNP eval: 101it [02:01,  1.13s/it]CNP eval: 102it [02:02,  1.10s/it]CNP eval: 103it [02:03,  1.08s/it]CNP eval: 104it [02:04,  1.16s/it]CNP eval: 105it [02:05,  1.24s/it]CNP eval: 106it [02:07,  1.26s/it]CNP eval: 107it [02:08,  1.18s/it]CNP eval: 108it [02:09,  1.23s/it]CNP eval: 109it [02:11,  1.31s/it]CNP eval: 110it [02:12,  1.37s/it]CNP eval: 111it [02:13,  1.25s/it]CNP eval: 112it [02:14,  1.18s/it]CNP eval: 113it [02:16,  1.27s/it]CNP eval: 114it [02:17,  1.19s/it]CNP eval: 115it [02:18,  1.22s/it]CNP eval: 116it [02:19,  1.28s/it]CNP eval: 117it [02:21,  1.34s/it]CNP eval: 118it [02:22,  1.37s/it]CNP eval: 119it [02:24,  1.33s/it]CNP eval: 120it [02:25,  1.37s/it]CNP eval: 121it [02:26,  1.32s/it]CNP eval: 122it [02:27,  1.22s/it]CNP eval: 123it [02:28,  1.16s/it]CNP eval: 124it [02:30,  1.27s/it]CNP eval: 125it [02:31,  1.29s/it]CNP eval: 125it [02:31,  1.21s/it]
--------------------
Model: CNP
Mean LL: 0.14455787006020546 STD LL: 0.004066937826079904 Mean RMSE: 0.2238366824388504 STD RMSE: 0.0008416663791273647 Num Samples: 50 Mean UnrRMSE: 0.9892603621482849 STD UnrRMSE: 0.005651217768315475 Total Unroltime: 66.69794201660156

Exact cache already present: True
Exact cache already present: True
Exact cache already present: True
wandb:   1 of 1 files downloaded.  
ConvCNP (50 x 50) eval: 0it [00:00, ?it/s]ConvCNP (50 x 50) eval: 1it [00:25, 25.33s/it]ConvCNP (50 x 50) eval: 1it [00:31, 31.07s/it]
Traceback (most recent call last):
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/experiments/arnphad_isd.py", line 562, in <module>
    compare_had_models(base_out_txt_file="experiments/plot_results/hadar/ar_had_comp_cnpsnew", rollout_rmse=True)
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/experiments/arnphad_isd.py", line 524, in compare_had_models
    pred_dist = ar_predict(model=model, xc=batch.xc.to(device), yc=batch.yc.to(device), xt=batch.xt.to(device),
  File "/home/pm846/.conda/envs/tnpp/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/experiments/arnphad_isd.py", line 140, in ar_predict
    model.update_ctx(xc=xc_stacked, yc=yc_stacked,use_flash=use_flash)
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/tnp/models/convcnp.py", line 149, in update_ctx
    self.inc_cache["z_grid"] = setconv_to_grid(xc_coords, z_feats, self.inc_cache["x_grid"], 
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/tnp/networks/setconv.py", line 210, in setconv_to_grid
    dists2 = dist_fn(x_grid_flat, x)
  File "/rds/user/pm846/hpc-work/Thesis/TNP-Inc/tnp/utils/distances.py", line 20, in sq_dist
    return (x1_ - x2_).pow(2)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 48.07 GiB. GPU 
